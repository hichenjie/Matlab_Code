%魔力退火程序的约判断束函数
function K=FunSt(S)
%S=[[0.100356431989674,0.157079632679490,0.213802833369305,0.270526034059121,0.327249234748937,0.383972435438753,0.440695636128568,0.497418836818384,0.504142037508200,0.510865238198015;] 5600 520]
%S=[[0.100356431989674,0.18079632679490,0.213802833369305,0.270526034059121,0.327249234748937,0.383972435438753,0.440695636128568,0.497418836818384,0.504142037508200,0.63865238198015;] 5795 517]


u=1;
r=zeros(1,10);
theata=zeros(1,10);
v=zeros(1,10);
omg=zeros(1,10);
m=zeros(1,10);

r(1,1)=1;
theata(1,1)=0;
v(1,1)=0;
omg(1,1)=1.0123078;
m(1,1)=1;


F=S(11)./7500;
t=S(12)./1047.6301./9;

for i=2:10
    m(i)=m(i-1)-F.*t./1.7574937;
    r(i)=r(i-1)-v(i-1).*t;
    v(i)=v(i-1)+(F.*sin(S(i-1))./m(i-1)-u./(r(i-1).^2)+r(i-1).*omg(i-1).^2).*t;
    theata(i)=theata(i-1)+omg(i-1).*t;
    omg(i)=omg(i-1)-(F./m(i-1).*cos(S(i-1))+2.*v(i-1).*omg(i-1)).*t./r(i-1);   
    
end


a=abs(r(10)-0.98993);
b=abs(theata(10)- 0.661131);
c=abs(abs(v(10)));
d=abs(omg(10)-0.1);

if a<0.13&&b<0.52&&d<0.52&&c<0.01
    K=1;
else
    K=0;
end

v=-1*v*1672.3584;
x=0.1:0.1:1;
x=S(12).*x;
plot(x,v);
ylabel('径向速度（m/s）')
xlabel('时间（s）')
% hold on
% r=r*1752;
% x=0.1:0.1:1;
% x=S(12).*x;
% plot(x,r);
% ylabel('月心距离（km）')
% xlabel('时间（s）')

% x=0.1:0.1:1;
% x=S(12).*x;
% plot(x,theata);
% ylabel('theata（rad）')
% xlabel('时间（s）')

% omg=omg*1.0123078;
% x=0.1:0.1:1;
% x=S(12).*x;
% plot(x,omg);
% ylabel('角速度（rad/s）')
% xlabel('时间（s）')




end
%



